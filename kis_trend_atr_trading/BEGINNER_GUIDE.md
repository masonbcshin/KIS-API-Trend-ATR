# 🎮 KIS 자동매매 프로그램 - 완전 초보자를 위한 안내서

> **이 설명서의 목표**: 코딩을 전혀 모르는 중학생도 이 프로그램을 설치하고, 테스트하고, 안전하게 모의투자까지 실행할 수 있도록 돕는 것

---

## 📚 목차

1. [이 프로그램은 무엇을 하는 프로그램인가?](#1-이-프로그램은-무엇을-하는-프로그램인가)
2. [이 프로그램으로 할 수 있는 것 / 하면 안 되는 것](#2-이-프로그램으로-할-수-있는-것--하면-안-되는-것)
3. [준비물](#3-준비물)
4. [전체 흐름 한 장 요약](#4-전체-흐름-한-장-요약)
5. [설치 방법](#5-설치-방법)
6. [프로그램 실행 방법](#6-프로그램-실행-방법)
7. [테스트(백테스트)란 무엇인가?](#7-테스트백테스트란-무엇인가)
8. [테스트 실행 방법](#8-테스트-실행-방법)
9. [테스트 결과를 어떻게 해석해야 하는가?](#9-테스트-결과를-어떻게-해석해야-하는가)
10. [모의투자란 무엇인가?](#10-모의투자란-무엇인가)
11. [모의투자 실행 방법](#11-모의투자-실행-방법)
12. [테스트 코드(pytest)는 무엇이고 왜 필요한가?](#12-테스트-코드pytest는-무엇이고-왜-필요한가)
13. [테스트 코드 실행 방법과 해석법](#13-테스트-코드-실행-방법과-해석법)
14. [절대 하면 안 되는 실수 TOP 10](#14-절대-하면-안-되는-실수-top-10)
15. [실계좌 적용은 왜 위험한가?](#15-실계좌-적용은-왜-위험한가)
16. [실계좌 적용 전 반드시 지켜야 할 조건](#16-실계좌-적용-전-반드시-지켜야-할-조건)
17. [문제가 생겼을 때 대처 방법](#17-문제가-생겼을-때-대처-방법)
18. [이 프로그램을 안전하게 공부용으로 쓰는 방법](#18-이-프로그램을-안전하게-공부용으로-쓰는-방법)

---

## 1. 이 프로그램은 무엇을 하는 프로그램인가?

### 한 줄 요약
> **주식을 자동으로 사고파는 프로그램**입니다.

### 쉬운 비유로 설명

게임을 할 때 "매크로"나 "자동사냥" 기능을 본 적 있나요?

- 게임 매크로: 내가 자는 동안에도 캐릭터가 몬스터를 잡아요
- **자동매매**: 내가 자는 동안에도 프로그램이 주식을 사고팔아요

이 프로그램은 **주식 시장의 자동 플레이어**라고 생각하면 됩니다.

### 이 프로그램의 전략

이 프로그램은 "**추세 추종 전략**"을 사용합니다.

쉽게 말하면:
- 주가가 **올라가는 중**이면 → 사요 (올라가는 버스에 타기)
- 주가가 **내려가기 시작**하면 → 팔아요 (내려가기 전에 버스에서 내리기)

### "ATR"이 뭔데요?

ATR은 "**주가가 얼마나 많이 움직이는지**"를 숫자로 나타낸 것입니다.

비유하자면:
- ATR이 크다 = 롤러코스터처럼 오르내림이 심하다
- ATR이 작다 = 천천히 가는 기차처럼 안정적이다

이 프로그램은 ATR을 보고:
- "손절가" (여기까지 내려가면 손해 보고 판다)
- "익절가" (여기까지 올라가면 이익 보고 판다)

를 자동으로 계산해요.

---

## 2. 이 프로그램으로 할 수 있는 것 / 하면 안 되는 것

### ✅ 할 수 있는 것

| 기능 | 설명 |
|------|------|
| 백테스트 | 과거 데이터로 "이 전략이 얼마나 잘 작동했을까?" 테스트 |
| 모의투자 | 가짜 돈으로 실전처럼 연습 |
| 텔레그램 알림 | 주문이 체결되면 휴대폰으로 알림 |
| 자동 손절 | 손실이 커지기 전에 자동으로 판매 |

### ❌ 하면 안 되는 것

| 행동 | 이유 |
|------|------|
| 실계좌로 바로 사용 | 돈을 잃을 수 있음 |
| 결과를 100% 믿기 | 과거가 좋았다고 미래도 좋은 건 아님 |
| 설정 파일 공유 | API 키가 노출되면 해킹당할 수 있음 |
| 24시간 켜두기 | 장 마감 후에는 의미 없음 |

### ⚠️ 중요한 경고

```
╔═══════════════════════════════════════════════════════════════════╗
║                                                                   ║
║   이 프로그램은 수익을 보장하지 않습니다!                         ║
║                                                                   ║
║   주식 투자는 원금 손실의 위험이 있습니다.                        ║
║   어떤 프로그램도, 어떤 전략도 100% 수익을 보장할 수 없습니다.    ║
║                                                                   ║
╚═══════════════════════════════════════════════════════════════════╝
```

---

## 3. 준비물

### 필요한 것들 체크리스트

#### 1️⃣ 컴퓨터
- [x] Windows, Mac, 또는 Linux 컴퓨터
- [x] 인터넷 연결

#### 2️⃣ 계정 (무료)
- [x] **한국투자증권 계정** - 모의투자 API 키 발급용
- [x] **텔레그램 계정** (선택) - 알림 받으려면 필요

#### 3️⃣ 프로그램 (무료)
- [x] **Python** - 이 프로그램을 돌리는 엔진
- [x] **터미널** - 컴퓨터에 명령을 내리는 창
- [x] **텍스트 편집기** - 메모장 같은 것 (VS Code 추천)

#### 4️⃣ 시간
- [x] 설치: 약 30분
- [x] 첫 테스트: 약 10분
- [x] 이해하기: 며칠~몇 주 (천천히!)

### "터미널"이 뭔가요?

터미널은 **컴퓨터와 대화하는 창**입니다.

평소에는 마우스로 클릭해서 프로그램을 실행하잖아요?
터미널은 **글자를 입력**해서 프로그램을 실행합니다.

마치 게임에서 "채팅창에 명령어 입력"하는 것과 비슷해요!

#### 터미널 여는 방법

**Windows:**
1. 키보드에서 `Windows 키` + `R` 누르기
2. `cmd` 입력하고 엔터

**Mac:**
1. `Command` + `Space` 누르기
2. `터미널` 입력하고 엔터

### "Python"이 뭔가요?

Python은 **프로그래밍 언어**입니다.

이 자동매매 프로그램이 Python이라는 언어로 작성되어 있어요.
책을 읽으려면 그 언어를 알아야 하듯이, 이 프로그램을 실행하려면 컴퓨터에 Python을 설치해야 해요.

---

## 4. 전체 흐름 한 장 요약

```
╔═══════════════════════════════════════════════════════════════════════════════╗
║                         자동매매 프로그램 사용 순서                             ║
╠═══════════════════════════════════════════════════════════════════════════════╣
║                                                                               ║
║   1단계: 준비하기                                                             ║
║   ┌─────────────────────────────────────────────────────────────────────┐    ║
║   │  Python 설치 → 프로그램 다운로드 → API 키 발급 → 설정 파일 작성    │    ║
║   └─────────────────────────────────────────────────────────────────────┘    ║
║                                    ↓                                          ║
║   2단계: 연습하기 (백테스트)                                                  ║
║   ┌─────────────────────────────────────────────────────────────────────┐    ║
║   │  과거 데이터로 "이 전략이 잘 작동했나?" 테스트                      │    ║
║   │  → 결과 확인 → 전략 이해하기                                        │    ║
║   └─────────────────────────────────────────────────────────────────────┘    ║
║                                    ↓                                          ║
║   3단계: 모의투자                                                             ║
║   ┌─────────────────────────────────────────────────────────────────────┐    ║
║   │  가짜 돈으로 실제 시장에서 연습                                     │    ║
║   │  → 최소 3개월 이상 → 결과 분석                                      │    ║
║   └─────────────────────────────────────────────────────────────────────┘    ║
║                                    ↓                                          ║
║   4단계: 실계좌 (⚠️ 매우 신중하게!)                                          ║
║   ┌─────────────────────────────────────────────────────────────────────┐    ║
║   │  진짜 돈으로 투자 (손실 위험 있음!)                                 │    ║
║   │  ★ 이 설명서에서는 3단계까지만 다룹니다 ★                          │    ║
║   └─────────────────────────────────────────────────────────────────────┘    ║
║                                                                               ║
╚═══════════════════════════════════════════════════════════════════════════════╝
```

### 게임에 비유하면

| 단계 | 게임 비유 | 자동매매 |
|------|----------|---------|
| 1단계 | 게임 설치 | 프로그램 설치 |
| 2단계 | 튜토리얼 | 백테스트 (연습 모드) |
| 3단계 | 일반 게임 | 모의투자 (돈 안 드는 실전 연습) |
| 4단계 | 랭크전 | 실계좌 (진짜 돈으로 하는 랭크전) |

---

## 5. 설치 방법

> 💡 **팁**: 이 부분은 차근차근 따라하세요. 한 단계씩!

### 5.1 Python 설치하기

#### 왜 필요한가요?
이 프로그램은 Python이라는 언어로 만들어져 있어요.
Python을 설치해야 프로그램이 돌아갑니다.

#### 설치 방법 (Windows)

**1단계: 다운로드**
```
https://www.python.org/downloads/
```
위 주소로 가서 "Download Python 3.x.x" 버튼을 클릭하세요.

**2단계: 설치하기**

⚠️ **매우 중요!** 설치 화면에서 반드시:

```
☑️ "Add Python to PATH" 체크하기!!!
```

이걸 체크 안 하면 나중에 Python이 작동 안 해요!

**3단계: 설치 확인**

터미널을 열고 이렇게 입력하세요:
```bash
python --version
```

이런 결과가 나오면 성공:
```
Python 3.11.5
```

> 🔧 **문제 해결**: "python을 찾을 수 없습니다" 에러가 나오면?
> - Python을 다시 설치하고, 이번에는 "Add Python to PATH"를 꼭 체크하세요!

### 5.2 프로그램 다운로드하기

#### 왜 필요한가요?
이제 자동매매 프로그램 자체를 받아야 해요.

#### 방법 1: ZIP 파일로 받기 (쉬움)

1. GitHub에서 프로젝트 페이지로 가기
2. 초록색 "Code" 버튼 클릭
3. "Download ZIP" 클릭
4. 다운로드된 ZIP 파일 압축 풀기
5. 원하는 폴더로 이동

#### 방법 2: Git으로 받기 (개발자스러움)

터미널에서:
```bash
git clone <저장소주소>
cd kis_trend_atr_trading
```

### 5.3 필요한 도구들 설치하기

#### 왜 필요한가요?
이 프로그램은 다른 프로그램들의 도움을 받아요.
마치 레고를 조립하려면 여러 블록이 필요하듯이요.

#### 설치 방법

터미널에서 프로그램 폴더로 이동한 후:

```bash
pip install -r requirements.txt
```

> 💡 **설명**: `pip`는 Python 세계의 "앱 스토어"예요. 필요한 도구들을 자동으로 설치해줍니다.

이런 메시지가 나오면 성공:
```
Successfully installed pandas-2.0.0 numpy-1.24.0 ...
```

### 5.4 한국투자증권 API 키 발급받기

#### 왜 필요한가요?
API 키는 **출입증** 같은 거예요.
한국투자증권의 데이터를 사용하려면 출입증이 필요합니다.

#### 발급 방법

**1단계: 회원가입**
```
https://apiportal.koreainvestment.com/
```
위 사이트에서 회원가입하세요.

**2단계: 앱 등록**
1. 로그인 후 "API 신청" 메뉴
2. "앱 등록" 클릭
3. 앱 이름 입력 (예: "자동매매연습")
4. **⚠️ 중요: "모의투자" 선택!!!** (실전투자 선택하면 안 됨!)

**3단계: 키 확인**
- **App Key**: 긴 영문+숫자 조합
- **App Secret**: 더 긴 영문+숫자 조합

이 두 개를 메모장에 복사해두세요.

```
╔════════════════════════════════════════════════════════════════╗
║  ⚠️ 경고: API 키는 비밀번호입니다!                            ║
║                                                                ║
║  - 다른 사람에게 보여주면 안 됩니다                           ║
║  - 인터넷에 올리면 안 됩니다                                  ║
║  - 카카오톡으로 보내면 안 됩니다                              ║
╚════════════════════════════════════════════════════════════════╝
```

### 5.5 설정 파일 만들기

#### 왜 필요한가요?
프로그램에게 "내 API 키가 뭔지, 내 계좌가 뭔지" 알려줘야 해요.

#### 방법

**1단계: 예시 파일 복사**

프로그램 폴더에서:
- `.env.example` 파일을 찾으세요
- 이 파일을 복사해서 `.env`로 이름 바꾸세요

**Windows에서:**
```bash
copy .env.example .env
```

**Mac/Linux에서:**
```bash
cp .env.example .env
```

**2단계: 파일 내용 수정**

`.env` 파일을 메모장(또는 VS Code)으로 열어서 수정하세요:

```env
# 여기에 발급받은 키를 입력하세요
KIS_APP_KEY=여기에_App_Key_붙여넣기
KIS_APP_SECRET=여기에_App_Secret_붙여넣기

# 계좌번호 (8자리 숫자)
KIS_ACCOUNT_NO=12345678
KIS_ACCOUNT_PRODUCT_CODE=01
```

> 💡 **팁**: `your_app_key_here` 같은 예시 텍스트를 지우고, 실제 값을 입력하세요!

**3단계: 저장**

파일을 저장하세요. (Ctrl+S 또는 Command+S)

### 5.6 설정 파일 이해하기 (main_v2.py용)

> 💡 **참고**: main.py만 사용할 거라면 이 부분은 건너뛰어도 돼요!

`main_v2.py`를 사용하려면 YAML 설정 파일도 알아야 해요.

#### YAML 파일이 뭔가요?

**YAML**은 설정을 저장하는 파일 형식이에요. 메모장처럼 읽기 쉽게 생겼어요.

```yaml
# 이게 YAML 파일 예시예요
strategy:
  atr_period: 14        # ATR 계산에 14일 사용
  trend_ma_period: 50   # 추세 판단에 50일 이동평균 사용
```

#### 설정 파일 위치

```
config/
├── dev.yaml    ← 모의투자(DEV) 환경 설정
└── prod.yaml   ← 실계좌(PROD) 환경 설정
```

#### 주요 설정값 설명

**config/dev.yaml** 또는 **config/prod.yaml** 안에 있는 값들:

```yaml
# 주문 관련 설정
order:
  allow_order: true       # true면 주문 가능, false면 주문 차단
  default_stock_code: "005930"  # 기본 종목 (삼성전자)
  default_quantity: 1     # 한 번에 몇 주 살지

# 전략 관련 설정  
strategy:
  atr_period: 14          # ATR 계산 기간 (보통 14일)
  trend_ma_period: 50     # 추세 판단 기간 (보통 50일)
  atr_multiplier_sl: 2.0  # 손절 배수 (ATR의 2배)
  atr_multiplier_tp: 3.0  # 익절 배수 (ATR의 3배)

# 위험 관리 설정
risk:
  max_loss_pct: 5.0       # 최대 손실 허용 (5%)
  daily_max_loss_percent: 3.0  # 일일 최대 손실 (3%)
  enable_kill_switch: false    # 긴급 정지 (true면 모든 주문 차단!)
```

> ⚠️ **주의**: 설정값을 바꿀 때는 반드시 백업해두세요!

---

## 6. 프로그램 실행 방법

### 실행 전 체크리스트

프로그램을 실행하기 전에 확인하세요:

- [x] Python이 설치되어 있나요?
- [x] 필요한 도구들이 설치되어 있나요? (`pip install -r requirements.txt`)
- [x] `.env` 파일에 API 키를 입력했나요?
- [x] 터미널에서 프로그램 폴더 안에 있나요?

### 폴더 이동 방법

터미널에서 프로그램 폴더로 이동하려면:

```bash
cd 폴더경로/kis_trend_atr_trading
```

예시:
```bash
# Windows
cd C:\Users\내이름\Downloads\kis_trend_atr_trading

# Mac
cd /Users/내이름/Downloads/kis_trend_atr_trading
```

### 두 가지 실행 파일

이 프로그램에는 **두 가지 버전**의 실행 파일이 있어요:

| 파일 | 설명 | 추천 |
|------|------|------|
| `main.py` | 기본 버전 (모의투자 전용) | 처음 배우는 분 |
| `main_v2.py` | 고급 버전 (DEV/PROD 환경 분리) | 익숙해진 후 |

> 💡 **초보자 추천**: 처음에는 `main.py`를 사용하세요. `main_v2.py`는 나중에 실계좌까지 고려할 때 사용합니다.

### 두 가지 실행 모드

두 파일 모두 "모드"를 선택해서 실행해요:

| 모드 | 설명 | 명령어 |
|------|------|--------|
| backtest | 과거 데이터로 테스트 | `python main.py --mode backtest` |
| trade | 실시간 모의투자 | `python main.py --mode trade` |

### main.py vs main_v2.py 차이점

```
╔═══════════════════════════════════════════════════════════════════════════════╗
║                      main.py vs main_v2.py 비교                               ║
╠═══════════════════════════════════════════════════════════════════════════════╣
║                                                                               ║
║   main.py (기본 버전)                                                         ║
║   ├── 모의투자 전용                                                           ║
║   ├── 설정이 단순함                                                           ║
║   └── 초보자에게 추천                                                         ║
║                                                                               ║
║   main_v2.py (고급 버전)                                                      ║
║   ├── DEV(모의투자) / PROD(실계좌) 환경 분리                                  ║
║   ├── 2단계 안전장치 포함                                                     ║
║   ├── YAML 설정 파일 사용                                                     ║
║   └── 실계좌까지 고려할 때 사용                                               ║
║                                                                               ║
╚═══════════════════════════════════════════════════════════════════════════════╝
```

---

## 7. 테스트(백테스트)란 무엇인가?

### 한 줄 요약
> **과거 데이터로 "이 전략이 잘 작동했을까?" 확인하는 것**

### 쉬운 비유

상상해보세요:
1. 오늘이 2025년 1월이에요
2. "만약 2024년 1월에 이 전략을 썼다면 어떻게 됐을까?"
3. 컴퓨터가 2024년 1월~12월 데이터로 가상으로 거래해봐요
4. "이 전략으로 10% 벌었을 것이다" 같은 결과가 나와요

이게 바로 **백테스트**예요!

### 게임에 비유하면

```
백테스트 = 공략 영상 보기

실제로 게임 안 하고, 영상 보면서
"이 방법으로 하면 보스 잡을 수 있겠다" 확인하는 것
```

### 백테스트의 한계

⚠️ **매우 중요한 주의사항**:

```
╔═══════════════════════════════════════════════════════════════════╗
║                                                                   ║
║   백테스트 결과가 좋았다고 해서                                   ║
║   앞으로도 좋을 것이라는 보장은 없습니다!                         ║
║                                                                   ║
║   과거 시험 문제를 풀어봤다고                                     ║
║   이번 시험도 100점 받는 건 아니잖아요?                           ║
║                                                                   ║
╚═══════════════════════════════════════════════════════════════════╝
```

---

## 8. 테스트 실행 방법

### 기본 실행

터미널에서:

```bash
python main.py --mode backtest
```

### 실행 결과 예시

```
╔═══════════════════════════════════════════════════════════════════════════════╗
║                                                                               ║
║     ██╗  ██╗██╗███████╗    ████████╗██████╗ ███████╗███╗   ██╗██████╗        ║
║     ██║ ██╔╝██║██╔════╝    ╚══██╔══╝██╔══██╗██╔════╝████╗  ██║██╔══██╗       ║
║     ...                                                                       ║
║                                                                               ║
╚═══════════════════════════════════════════════════════════════════════════════╝

======================================================================
                         백테스트 모드
======================================================================

📊 종목코드: 005930
📅 기간: 최근 365일
💰 초기 자본금: 10,000,000원

전략 파라미터:
  - ATR 기간: 14일
  - 추세 MA: 50일
  - 손절 배수: 2.0x ATR
  - 익절 배수: 3.0x ATR
======================================================================

🔑 API 토큰 발급 중...
✅ 토큰 발급 완료

📈 시장 데이터 조회 중...
✅ 데이터 조회 완료: 365개 캔들

🔄 백테스트 실행 중...
```

### 옵션 설명

| 옵션 | 설명 | 예시 |
|------|------|------|
| `--stock` | 테스트할 종목 | `--stock 005930` (삼성전자) |
| `--days` | 테스트 기간 | `--days 500` (500일) |

### 다양한 실행 예시

```bash
# 기본 실행 (삼성전자, 1년)
python main.py --mode backtest

# SK하이닉스로 테스트
python main.py --mode backtest --stock 000660

# 2년치 데이터로 테스트
python main.py --mode backtest --days 730
```

### 자주 사용하는 종목 코드

종목 코드는 6자리 숫자예요. 자주 거래되는 종목들의 코드입니다:

| 종목명 | 종목코드 | 참고 |
|--------|----------|------|
| 삼성전자 | 005930 | 시가총액 1위 |
| SK하이닉스 | 000660 | 반도체 |
| LG에너지솔루션 | 373220 | 배터리 |
| 삼성바이오로직스 | 207940 | 바이오 |
| 현대차 | 005380 | 자동차 |
| 기아 | 000270 | 자동차 |
| 셀트리온 | 068270 | 바이오 |
| KB금융 | 105560 | 금융 |
| 신한지주 | 055550 | 금융 |
| POSCO홀딩스 | 005490 | 철강 |
| 네이버 | 035420 | IT/플랫폼 |
| 카카오 | 035720 | IT/플랫폼 |
| 삼성SDI | 006400 | 배터리 |
| LG화학 | 051910 | 화학/배터리 |
| 현대모비스 | 012330 | 자동차부품 |

> 💡 **팁**: 처음에는 삼성전자(005930)로 연습하는 걸 추천해요. 거래량이 많고 안정적이에요.

---

## 9. 테스트 결과를 어떻게 해석해야 하는가?

### 결과 화면 예시

```
═══════════════════════════════════════════════════════════════════
                    백테스트 결과 요약
═══════════════════════════════════════════════════════════════════
📅 기간: 2024-01-01 ~ 2024-12-31

💰 자본금 변화
   - 초기 자본금:      10,000,000 원
   - 최종 자본금:      11,234,567 원
   - 총 수익률:             12.35 %

📊 거래 통계
   - 총 거래 횟수:          15 회
   - 승리:                   9 회
   - 패배:                   6 회
   - 승률:               60.00 %

📉 리스크 지표
   - 최대 낙폭(MDD):       8.45 %
   - 수익 팩터:            1.85

⏱️ 보유 기간
   - 평균 보유 기간:       12.3 일
═══════════════════════════════════════════════════════════════════
```

### 각 지표 설명

#### 💰 총 수익률

**의미**: 처음 돈에서 얼마나 벌었나/잃었나

**계산**: (최종 자본금 - 초기 자본금) / 초기 자본금 × 100

**예시**:
- +12.35% → 1000만원이 1123만원이 됨 (좋음)
- -5.00% → 1000만원이 950만원이 됨 (손실)

**비유**: 게임에서 "경험치 %"와 비슷해요. 플러스면 레벨업, 마이너스면 레벨다운!

#### 📊 승률

**의미**: 전체 거래 중 돈을 번 거래의 비율

**계산**: 이긴 횟수 / 전체 횟수 × 100

**예시**:
- 60% → 10번 거래 중 6번 이익
- 40% → 10번 거래 중 4번 이익 (6번 손해)

**중요한 점**: 
```
승률이 높다고 무조건 좋은 게 아닙니다!

승률 90%인데 이길 때 1만원 벌고, 질 때 100만원 잃으면?
→ 결국 손해예요!
```

#### 📉 최대 낙폭 (MDD)

**의미**: "가장 많이 떨어졌던 순간"이 얼마나 떨어졌나

**비유**: 롤러코스터 타다가 가장 무서웠던 내리막길의 높이

**예시**:
- MDD 8.45% → 가장 힘들 때 8.45% 손해 상태였음
- MDD 30% → 가장 힘들 때 30% 손해 상태였음 (위험!)

**왜 중요한가요?**
```
1000만원으로 시작했는데 MDD가 30%라면,
어느 순간 700만원까지 떨어졌다는 뜻이에요.

그 순간 버틸 수 있나요? 
"아 망했다!" 하고 그만둘 것 같지 않나요?

MDD가 작을수록 마음 편하게 투자할 수 있어요.
```

#### 🔢 수익 팩터

**의미**: 번 돈 / 잃은 돈

**예시**:
- 1.85 → 100원 잃을 때마다 185원 벌었음 (좋음)
- 1.00 → 번 만큼 잃음 (본전)
- 0.50 → 100원 벌 때마다 200원 잃음 (나쁨)

**기준**:
- 1.5 이상 → 괜찮음
- 2.0 이상 → 좋음
- 1.0 미만 → 손해 보는 전략

### 결과 해석 가이드

| 상황 | 의미 | 할 일 |
|------|------|------|
| 수익률 (+), 승률 높음, MDD 낮음 | 좋은 결과 | 모의투자로 확인해보기 |
| 수익률 (+), 승률 낮음 | 적게 이기지만 크게 벌음 | 괜찮을 수 있음 |
| 수익률 (-) | 이 전략은 이 종목에서 손해 | 다른 종목/기간 테스트 |
| MDD 매우 높음 (30% 이상) | 중간에 큰 손실이 있었음 | 실제로 버틸 수 있는지 생각 |

### ⚠️ 백테스트 결과를 볼 때 주의할 점

```
╔═══════════════════════════════════════════════════════════════════════════════╗
║                                                                               ║
║   백테스트 결과가 좋다고 바로 실계좌에서 쓰면 안 됩니다!                       ║
║                                                                               ║
║   이유:                                                                       ║
║   1. 과거와 미래는 다릅니다                                                   ║
║   2. 실제 거래에서는 예상 못한 일이 생깁니다                                  ║
║   3. 수수료, 슬리피지 등 추가 비용이 있습니다                                 ║
║                                                                               ║
║   반드시 모의투자로 먼저 확인하세요!                                          ║
║                                                                               ║
╚═══════════════════════════════════════════════════════════════════════════════╝
```

---

## 10. 모의투자란 무엇인가?

### 한 줄 요약
> **가짜 돈으로 실제 주식 시장에서 연습하는 것**

### 쉬운 비유

| 비유 | 설명 |
|------|------|
| 게임 연습 모드 | 실제 게임이랑 똑같은데, 랭크 점수는 안 깎임 |
| 운전 시뮬레이터 | 진짜 차 운전하는 것처럼 연습하는데, 사고 나도 안 다침 |
| 모의투자 | 진짜 주식시장에서 거래하는데, 진짜 돈은 안 씀 |

### 백테스트 vs 모의투자

| 구분 | 백테스트 | 모의투자 |
|------|----------|----------|
| 시간 | 과거 | 현재 (실시간) |
| 데이터 | 이미 정해진 과거 데이터 | 실시간 시장 데이터 |
| 돈 | 가상의 계산 | 가짜 돈 (증권사 제공) |
| 체험 | "이랬을 것이다" | "실제로 이렇게 된다" |
| 감정 | 없음 | 있음 (떨림, 조급함) |

### 왜 모의투자를 해야 하나요?

```
백테스트: "과거에 이 전략이 잘 됐네!"
         ↓
모의투자: "지금도 잘 되나 확인해보자"
         ↓
        "어? 생각보다 다르네..."
        또는
        "오! 진짜 잘 되네!"
```

모의투자를 하면:
1. **실제 시장의 움직임**을 느낄 수 있어요
2. **내 심리 상태**를 확인할 수 있어요 (손해 볼 때 어떤 기분인지)
3. **프로그램이 제대로 작동하는지** 확인할 수 있어요

---

## 11. 모의투자 실행 방법

### 기본 실행

```bash
python main.py --mode trade
```

### 실행 결과 예시

```
======================================================================
                        모의투자 거래 모드
======================================================================

📊 종목코드: 005930
⏱️  실행 간격: 60초
🔄 최대 실행 횟수: 무제한

⚠️  주의: 모의투자 전용입니다. 실계좌 주문이 발생하지 않습니다.
======================================================================

🔑 API 토큰 발급 중...
✅ 토큰 발급 완료

🚀 거래 시작...

   종료하려면 Ctrl+C를 누르세요.

════════════════════════════════════════════════════════════════
  반복 #1 - 2024-01-15 09:31:00
════════════════════════════════════════════════════════════════

[Engine] 시장 데이터 조회 중... (005930)
[Engine] ✅ 데이터 조회 완료: 100개 캔들
[Engine] 현재가: 71,000원
[Engine] 시그널: HOLD | 추세: UP
[Engine] 사유: 포지션 없음, 진입 조건 미충족

[Engine] 다음 실행까지 60초 대기...
```

### 옵션 설명

| 옵션 | 설명 | 예시 |
|------|------|------|
| `--stock` | 거래할 종목 | `--stock 005930` |
| `--interval` | 몇 초마다 확인할지 | `--interval 120` (2분마다) |
| `--max-runs` | 최대 몇 번 확인할지 | `--max-runs 10` (10번만) |

### 다양한 실행 예시

```bash
# 기본 실행 (삼성전자, 60초 간격)
python main.py --mode trade

# 2분마다 확인
python main.py --mode trade --interval 120

# 10번만 실행하고 종료
python main.py --mode trade --max-runs 10

# SK하이닉스로 2분마다, 20번만
python main.py --mode trade --stock 000660 --interval 120 --max-runs 20
```

### 프로그램 종료하기

프로그램을 끄려면 키보드에서:
```
Ctrl + C
```
(Ctrl 키를 누른 상태에서 C 키 누르기)

### 주식 시장 운영 시간

```
╔═══════════════════════════════════════════════════════════════════╗
║                      주식 시장 운영 시간                          ║
╠═══════════════════════════════════════════════════════════════════╣
║                                                                   ║
║   평일 (월~금요일)                                               ║
║   - 정규장: 오전 9시 ~ 오후 3시 30분                             ║
║   - 시간외: 오후 3시 40분 ~ 오후 4시                             ║
║                                                                   ║
║   휴일 (토, 일, 공휴일)                                          ║
║   - 주식 시장 쉼 (프로그램 돌려도 거래 안 됨)                    ║
║                                                                   ║
╚═══════════════════════════════════════════════════════════════════╝
```

### 텔레그램 알림 설정 (선택)

거래가 발생할 때 휴대폰으로 알림을 받고 싶다면 텔레그램을 설정하세요.

#### 텔레그램이 뭔가요?

카카오톡 같은 메신저 앱이에요. 이 프로그램이 "주식 샀어요!", "주식 팔았어요!" 같은 알림을 보내줍니다.

#### 설정 방법

**1단계: 봇 만들기**
```
1. 휴대폰에서 텔레그램 앱 설치
2. 텔레그램에서 @BotFather 검색
3. 대화 시작하고 /newbot 입력
4. 봇 이름 입력 (예: 내자동매매알림)
5. 봇 아이디 입력 (예: my_trading_alert_bot)
   → 반드시 _bot으로 끝나야 해요!
6. 발급된 "토큰"을 메모장에 복사
   (예: 1234567890:ABCdefGHIjklMNOpqrsTUVwxyz)
```

**2단계: Chat ID 확인**
```
1. 방금 만든 봇을 검색해서 대화 시작
2. 아무 메시지나 보내기 (예: "안녕")
3. 웹 브라우저에서 아래 주소 접속:
   https://api.telegram.org/bot여기에토큰붙여넣기/getUpdates
4. 화면에서 "chat":{"id":숫자} 부분의 숫자 복사
```

**3단계: .env 파일에 추가**
```env
TELEGRAM_BOT_TOKEN=여기에_토큰_붙여넣기
TELEGRAM_CHAT_ID=여기에_Chat_ID_붙여넣기
TELEGRAM_ENABLED=true
```

**4단계: 테스트**
```bash
python -c "from utils.telegram_notifier import get_telegram_notifier; get_telegram_notifier().test_connection()"
```
휴대폰에 테스트 메시지가 오면 성공!

---

## 11-1. 일일 리포트 받기 (선택)

이 프로그램은 하루의 거래 결과를 정리해서 텔레그램으로 보내주는 기능이 있어요.

### 일일 리포트 실행 방법

```bash
# 오늘 리포트 받기
python report_sender.py

# 어제 리포트 받기
python report_sender.py --date yesterday

# 특정 날짜 리포트
python report_sender.py --date 2024-01-15

# 텔레그램 연결 테스트
python report_sender.py --test
```

### 자동으로 매일 받기 (고급)

리눅스/맥에서 cron이라는 기능을 사용하면 매일 자동으로 리포트를 받을 수 있어요.
자세한 방법은 `CRON_SETUP.md` 파일을 참고하세요.

---

## 12. 테스트 코드(pytest)는 무엇이고 왜 필요한가?

### 한 줄 요약
> **프로그램이 제대로 작동하는지 자동으로 확인해주는 도구**

### 쉬운 비유

**상황**: 자동차를 만들었어요.

| 방법 | 설명 |
|------|------|
| 직접 확인 | 차에 타서 직접 운전해봄 → 시간 오래 걸림 |
| 테스트 코드 | 컴퓨터가 자동으로 "브레이크 작동?", "에어백 작동?" 확인 |

**테스트 코드는 "자동 검사관"** 같은 거예요!

### 왜 테스트 코드가 필요한가요?

```
╔═══════════════════════════════════════════════════════════════════════════════╗
║                                                                               ║
║   "테스트 코드 실행하기 귀찮은데, 그냥 넘어가면 안 되나요?"                   ║
║                                                                               ║
║   → 안 됩니다! 테스트 코드는 "안전벨트" 같은 거예요.                         ║
║                                                                               ║
║   테스트 코드를 실행하면:                                                     ║
║   1. 프로그램이 고장났는지 바로 알 수 있어요                                 ║
║   2. 내가 뭔가 잘못 건드렸는지 확인할 수 있어요                              ║
║   3. 나중에 문제 생겼을 때 원인을 찾기 쉬워요                                ║
║                                                                               ║
║   귀찮아도 꼭 실행하세요! 1분이면 됩니다!                                    ║
║                                                                               ║
╚═══════════════════════════════════════════════════════════════════════════════╝
```

### 이 프로그램의 테스트 코드가 확인하는 것들

| 테스트 파일 | 확인 내용 | 중요도 |
|-------------|----------|--------|
| `test_strategy.py` | 전략이 올바른 신호를 보내는가? | ⭐⭐⭐ |
| `test_executor.py` | 주문이 제대로 실행되는가? | ⭐⭐⭐ |
| `test_api.py` | 증권사 API와 통신이 잘 되는가? | ⭐⭐⭐ |
| `test_risk_manager.py` | 위험 관리가 제대로 작동하는가? | ⭐⭐⭐ |
| `test_telegram_notifier.py` | 텔레그램 알림이 잘 가는가? | ⭐⭐ |
| `test_report.py` | 리포트가 제대로 만들어지는가? | ⭐⭐ |
| `test_integration.py` | 전체 시스템이 잘 연결되는가? | ⭐⭐⭐ |

---

## 13. 테스트 코드 실행 방법과 해석법

### 테스트 코드 실행하기

터미널에서:

```bash
pytest tests/ -v
```

> 💡 **설명**: 
> - `pytest` = 테스트 실행 명령어
> - `tests/` = 테스트 파일이 있는 폴더
> - `-v` = 자세하게 보여줘 (verbose)

### 실행 결과 예시 - 성공

```
========================= test session starts ==========================
platform linux -- Python 3.11.5, pytest-8.0.0
collected 25 items

tests/test_strategy.py::test_uptrend_signal PASSED                [ 4%]
tests/test_strategy.py::test_downtrend_signal PASSED              [ 8%]
tests/test_strategy.py::test_stop_loss_calculation PASSED         [12%]
tests/test_executor.py::test_buy_order PASSED                     [16%]
tests/test_executor.py::test_sell_order PASSED                    [20%]
...

========================= 25 passed in 2.34s ===========================
```

**해석**: 
- 초록색 `PASSED` = 통과! 이 기능은 정상 작동
- 맨 아래 `25 passed` = 25개 테스트 모두 통과

### 실행 결과 예시 - 실패

```
========================= test session starts ==========================
tests/test_strategy.py::test_uptrend_signal PASSED                [ 4%]
tests/test_strategy.py::test_stop_loss_calculation FAILED         [12%]

================================ FAILURES ================================
_________________ test_stop_loss_calculation _____________________________

    def test_stop_loss_calculation():
>       assert stop_loss == 57000
E       AssertionError: assert 58000 == 57000

========================= 1 failed, 24 passed in 2.34s ==================
```

**해석**:
- 빨간색 `FAILED` = 실패! 이 기능에 문제가 있음
- `AssertionError` = 예상한 값과 실제 값이 다름
- `1 failed, 24 passed` = 1개 실패, 24개 통과

### 실패했을 때 어떻게 해야 하나요?

1. **당황하지 마세요** - 테스트 실패는 "문제가 있다"는 알림일 뿐이에요
2. **에러 메시지를 읽어보세요** - 어떤 테스트가 왜 실패했는지 나와 있어요
3. **최근에 바꾼 게 있다면** - 그걸 원래대로 돌려보세요
4. **모르겠으면** - 처음부터 다시 설치해보세요

### 간단 테스트 명령어 모음

```bash
# 모든 테스트 실행
pytest tests/ -v

# 전략 테스트만 실행
pytest tests/test_strategy.py -v

# 실패한 테스트만 자세히 보기
pytest tests/ -v --tb=long

# 테스트 커버리지 확인 (얼마나 많이 테스트됐나)
pytest tests/ --cov=.
```

---

## 14. 절대 하면 안 되는 실수 TOP 10

### 🚫 실수 1: 설치 직후 바로 실계좌 실행

```
❌ 잘못된 예:
"설치 끝났다! 바로 실계좌로 돌려봐야지~"

⭕ 올바른 예:
"백테스트 → 모의투자 3개월 → 그래도 좋으면 소액으로 시작"
```

### 🚫 실수 2: API 키를 인터넷에 공유

```
❌ 잘못된 예:
- GitHub에 .env 파일 올리기
- 블로그에 API 키 스크린샷 올리기
- 카카오톡으로 친구에게 보내기

⭕ 올바른 예:
- .env 파일은 절대 공유 안 함
- API 키는 나만 알고 있음
```

### 🚫 실수 3: 백테스트 결과를 100% 신뢰

```
❌ 잘못된 생각:
"백테스트에서 50% 수익 나왔으니까 실계좌도 50% 벌겠지!"

⭕ 올바른 생각:
"백테스트는 참고만 하자. 실제로는 다를 수 있어."
```

### 🚫 실수 4: 잃어도 되는 돈 이상으로 투자

```
❌ 잘못된 예:
- 전 재산으로 투자
- 대출받아서 투자
- 생활비로 투자

⭕ 올바른 예:
- 잃어도 생활에 지장 없는 금액만
- "이 돈이 0원이 되어도 괜찮아" 하는 금액만
```

### 🚫 실수 5: 프로그램을 이해하지 않고 사용

```
❌ 잘못된 예:
"뭔지 모르겠는데 일단 실행해봐야지"

⭕ 올바른 예:
"백테스트가 뭔지, 손절이 뭔지 먼저 이해하고 실행하자"
```

### 🚫 실수 6: 손절을 끄거나 무시

```
❌ 잘못된 예:
"손절 맞으면 돈 잃으니까, 손절 기능 끄자"

⭕ 올바른 예:
"손절은 더 큰 손실을 막아주는 안전벨트야. 절대 끄면 안 돼."
```

**비유**: 손절 = 자동차 안전벨트
- 끄면 당장은 편할 수 있어요
- 하지만 사고 나면 크게 다쳐요!

### 🚫 실수 7: 결과가 좋을 때 욕심 부리기

```
❌ 잘못된 예:
"와 모의투자로 20% 벌었다! 실계좌로 전 재산 넣어야지!"

⭕ 올바른 예:
"좋은 결과지만, 조심하자. 소액부터 시작하자."
```

### 🚫 실수 8: 24시간 프로그램 방치

```
❌ 잘못된 예:
- 프로그램 켜놓고 일주일 동안 안 봄
- 에러 떠도 모름

⭕ 올바른 예:
- 매일 결과 확인
- 텔레그램 알림 설정
- 이상 있으면 바로 확인
```

### 🚫 실수 9: 여러 종목 동시에 무분별하게 실행

```
❌ 잘못된 예:
"10개 종목 동시에 돌려야 많이 벌겠지!"

⭕ 올바른 예:
"처음에는 1개 종목으로. 익숙해지면 천천히 늘리자."
```

### 🚫 실수 10: 테스트 코드 실행 안 함

```
❌ 잘못된 예:
"테스트? 귀찮아. 걍 실행하자."

⭕ 올바른 예:
"설정 바꿀 때마다 테스트 코드 돌려서 문제없나 확인하자."
```

---

## 14-1. main_v2.py 사용법 (고급)

> 💡 **참고**: 이 섹션은 `main.py`에 충분히 익숙해진 후에 읽으세요!

`main_v2.py`는 **DEV(모의투자)**와 **PROD(실계좌)** 환경을 분리한 고급 버전이에요.

### DEV vs PROD 환경

| 환경 | 설명 | 위험도 |
|------|------|--------|
| DEV | 모의투자 (기본값) | 안전 ✅ |
| PROD | 실계좌 (진짜 돈!) | 위험 ⚠️ |

### 환경 설정 방법

환경은 `TRADING_MODE` 환경변수로 설정해요.

**Windows:**
```bash
# 모의투자 (기본값이라 생략 가능)
set TRADING_MODE=DEV
python main_v2.py --mode trade

# 실계좌 (위험!)
set TRADING_MODE=PROD
python main_v2.py --mode trade
```

**Mac/Linux:**
```bash
# 모의투자
export TRADING_MODE=DEV
python main_v2.py --mode trade

# 실계좌 (위험!)
export TRADING_MODE=PROD
python main_v2.py --mode trade
```

### 설정 파일 구조

`main_v2.py`는 YAML 설정 파일을 사용해요:

```
config/
├── dev.yaml    ← DEV 환경 설정 (모의투자)
└── prod.yaml   ← PROD 환경 설정 (실계좌)
```

설정 파일에서 바꿀 수 있는 것들:

| 설정 | 설명 | 위치 |
|------|------|------|
| `atr_period` | ATR 계산 기간 | strategy 섹션 |
| `trend_ma_period` | 추세 판단 기간 | strategy 섹션 |
| `atr_multiplier_sl` | 손절 배수 | strategy 섹션 |
| `atr_multiplier_tp` | 익절 배수 | strategy 섹션 |
| `default_stock_code` | 기본 종목 | order 섹션 |
| `default_quantity` | 주문 수량 | order 섹션 |
| `allow_order` | 주문 허용 여부 | order 섹션 |
| `enable_kill_switch` | 긴급 정지 | risk 섹션 |

### 2단계 안전장치 (PROD 환경 전용)

실계좌(PROD) 환경에서는 **2단계 안전장치**가 작동해요:

```
╔═══════════════════════════════════════════════════════════════════════════════╗
║                        실계좌 2단계 안전장치                                  ║
╠═══════════════════════════════════════════════════════════════════════════════╣
║                                                                               ║
║   [1단계] 설정 파일 확인                                                      ║
║   ─────────────────────                                                       ║
║   config/prod.yaml 파일에서 allow_order: true 인지 확인                       ║
║   (기본값은 false라서 처음에는 주문 안 됨)                                    ║
║                                                                               ║
║   [2단계] 사용자 확인                                                         ║
║   ─────────────────                                                           ║
║   매 주문마다 콘솔에 "YES"를 직접 입력해야 함                                 ║
║   다른 거 입력하면 주문 취소됨                                                ║
║                                                                               ║
║   ★ 두 단계를 모두 통과해야만 실제 주문이 나감!                               ║
║                                                                               ║
╚═══════════════════════════════════════════════════════════════════════════════╝
```

### 킬 스위치 (긴급 정지)

위험 상황에서 모든 주문을 즉시 멈추는 기능이에요.

**사용 방법:**
1. `config/dev.yaml` 또는 `config/prod.yaml` 파일 열기
2. `enable_kill_switch: true`로 변경
3. 저장하면 즉시 모든 신규 주문 차단!

```yaml
risk:
  enable_kill_switch: true  # ← 이걸 true로 바꾸면 긴급 정지!
```

**언제 사용하나요?**
- 프로그램이 이상하게 작동할 때
- 시장이 급락/급등해서 불안할 때
- 잠시 거래를 멈추고 싶을 때

---

## 15. 실계좌 적용은 왜 위험한가?

```
╔═══════════════════════════════════════════════════════════════════════════════╗
║                                                                               ║
║                    ⚠️⚠️⚠️ 경고 ⚠️⚠️⚠️                                        ║
║                                                                               ║
║          실계좌 = 진짜 돈이 사라질 수 있습니다!                               ║
║                                                                               ║
╚═══════════════════════════════════════════════════════════════════════════════╝
```

### 모의투자 vs 실계좌 비교

| 구분 | 모의투자 | 실계좌 |
|------|----------|--------|
| 돈 | 가짜 돈 | 진짜 돈 |
| 손실 | 0원 | 진짜 내 돈이 사라짐 |
| 복구 | 리셋 가능 | 불가능 |
| 감정 | 담담함 | 공포, 후회, 조급함 |
| 실수 | 배움의 기회 | 금전적 손실 |

### 실계좌가 위험한 이유 5가지

#### 1️⃣ 진짜 돈이 사라집니다

```
모의투자: "어 -10% 됐네. 리셋하면 되지 뭐~"

실계좌: "아... 100만원 중에 10만원이 진짜로 사라졌어..."
```

#### 2️⃣ 감정이 개입합니다

모의투자에서는 쿨하게 판단할 수 있어요.
하지만 실계좌에서 손실이 나면:
- 조급함: "빨리 만회해야 해!"
- 두려움: "더 내려가면 어떡하지..."
- 탐욕: "조금만 더, 조금만 더..."

이런 감정들이 잘못된 결정을 내리게 해요.

#### 3️⃣ 백테스트와 실제는 다릅니다

```
백테스트 결과: +30% 수익
실제 결과: -15% 손실

왜?
- 백테스트는 "완벽한 세상"에서의 결과
- 실제는 예상 못한 일이 많이 생김
```

#### 4️⃣ 프로그램 버그의 위험

프로그램은 사람이 만든 거예요. 버그가 있을 수 있어요.

```
버그 예시:
- 1주 사려고 했는데 100주를 샀다
- 팔아야 하는데 더 샀다
- 손절이 안 되고 계속 들고 있다
```

#### 5️⃣ 시장의 예측 불가능성

```
2020년 3월: 코로나로 주식시장 폭락 (-30%)
2022년: 금리 인상으로 성장주 폭락

아무리 좋은 전략도 이런 상황에서는 손실을 봅니다.
```

### 게임에 비유

```
╔═══════════════════════════════════════════════════════════════════════════════╗
║                                                                               ║
║   모의투자 = 일반 게임                                                        ║
║   - 죽어도 다시 살아남                                                        ║
║   - 실력 늘릴 수 있음                                                         ║
║   - 부담 없이 도전 가능                                                       ║
║                                                                               ║
║   실계좌 = 하드코어 모드 (죽으면 캐릭터 삭제)                                 ║
║   - 실수하면 진짜 끝                                                          ║
║   - 복구 불가능                                                               ║
║   - 엄청난 실력자만 도전해야 함                                               ║
║                                                                               ║
║   당신은 아직 일반 게임도 충분히 안 해봤어요.                                 ║
║   하드코어 모드는 나중에 생각하세요!                                          ║
║                                                                               ║
╚═══════════════════════════════════════════════════════════════════════════════╝
```

---

## 16. 실계좌 적용 전 반드시 지켜야 할 조건

```
╔═══════════════════════════════════════════════════════════════════════════════╗
║                                                                               ║
║   ⚠️ 주의: 이 조건들을 충족하지 않으면 실계좌 사용을 권장하지 않습니다       ║
║                                                                               ║
╚═══════════════════════════════════════════════════════════════════════════════╝
```

### 필수 조건 체크리스트

#### ✅ 조건 1: 모의투자 3개월 이상 경험

```
[ ] 모의투자로 최소 3개월 이상 운영해봤다
[ ] 다양한 시장 상황(상승장, 하락장, 횡보장)을 경험했다
[ ] 모의투자 결과를 기록하고 분석했다
```

**왜?** 3개월이면 다양한 상황을 경험할 수 있어요.

#### ✅ 조건 2: 프로그램 완전히 이해

```
[ ] 백테스트가 무엇인지 설명할 수 있다
[ ] 손절/익절이 왜 필요한지 안다
[ ] ATR이 무엇인지 대략 이해한다
[ ] 프로그램 설정을 스스로 바꿀 수 있다
```

**왜?** 이해 못하는 건 위험해요.

#### ✅ 조건 3: 손실 각오

```
[ ] 투자금 전액을 잃어도 생활에 지장 없다
[ ] 가족에게 "이 돈 잃을 수도 있어"라고 말할 수 있다
[ ] 손실이 나도 프로그램이나 남 탓 안 할 자신이 있다
```

**왜?** 투자는 손실이 날 수 있어요.

#### ✅ 조건 4: 기술적 준비

```
[ ] 테스트 코드가 모두 통과한다 (pytest tests/ -v)
[ ] 텔레그램 알림이 제대로 온다
[ ] main_v2.py의 2단계 안전장치를 이해하고 있다
[ ] 킬 스위치(enable_kill_switch) 사용법을 알고 있다
[ ] config/prod.yaml의 allow_order 설정을 이해한다
[ ] 수동으로 주문 취소하는 방법을 알고 있다 (증권사 앱/웹)
```

**왜?** 문제가 생겼을 때 대응할 수 있어야 해요.

#### ✅ 조건 4-1: main_v2.py 안전장치 이해

```
PROD 환경 실계좌 주문 조건:

[1단계] config/prod.yaml 파일에서
       allow_order: true로 설정되어 있어야 함
       (기본값 false = 주문 차단)

[2단계] 매 주문마다 콘솔에서 "YES" 입력 필요
       (다른 입력 = 주문 취소)

★ 두 조건 모두 충족해야 실제 주문 실행!
```

#### ✅ 조건 5: 심리적 준비

```
[ ] -10% 손실이 나도 패닉하지 않을 자신이 있다
[ ] "이 돈은 없는 돈이야"라고 생각할 수 있다
[ ] 손실을 보고도 전략을 바꾸지 않을 인내심이 있다
```

**왜?** 감정적 결정이 가장 위험해요.

### 실계좌 시작 시 권장 사항

만약 위 조건을 모두 충족했다면:

```
1. 처음에는 투자금의 10%만 사용
   - 1000만원이면 100만원으로 시작
   
2. 최소 1개월은 관찰
   - 실계좌에서도 잘 작동하는지 확인
   
3. 문제없으면 천천히 증액
   - 한 번에 2배 이상 늘리지 않기
```

---

## 17. 문제가 생겼을 때 대처 방법

### 상황별 대처 가이드

#### 🔴 상황 1: 프로그램이 안 켜져요

**증상**: `python main.py --mode backtest` 치면 에러가 나요

**해결 방법**:
```
1. Python이 설치됐는지 확인
   → 터미널에서: python --version
   → 숫자가 나오면 OK, 에러 나면 Python 재설치

2. 필요한 도구가 설치됐는지 확인
   → 터미널에서: pip install -r requirements.txt

3. 프로그램 폴더에 있는지 확인
   → 터미널에서: ls (Mac) 또는 dir (Windows)
   → main.py가 보이면 OK
```

#### 🔴 상황 2: API 토큰 발급 실패

**증상**: "토큰 발급 실패" 에러

**해결 방법**:
```
1. .env 파일에 API 키가 제대로 입력됐는지 확인
   → 복사-붙여넣기 할 때 앞뒤 공백 없는지 확인
   
2. 한국투자증권 사이트에서 키가 유효한지 확인
   → 만료됐으면 새로 발급
   
3. 인터넷 연결 확인
```

#### 🔴 상황 3: 데이터 조회 실패

**증상**: "데이터 조회 실패: 데이터가 없습니다"

**해결 방법**:
```
1. 종목코드가 맞는지 확인
   → 삼성전자는 005930 (앞에 0 있음!)
   
2. 주식 시장 운영 시간인지 확인
   → 주말/공휴일은 데이터 조회 안 될 수 있음
   
3. 잠시 후 다시 시도
   → 일시적인 서버 문제일 수 있음
```

#### 🔴 상황 4: 테스트 코드 실패

**증상**: `pytest tests/ -v` 하면 빨간색 FAILED

**해결 방법**:
```
1. 에러 메시지 읽기
   → 어떤 테스트가 왜 실패했는지 나와 있음
   
2. 최근에 바꾼 게 있다면 원래대로 돌리기
   → 설정 파일 등을 건드렸다면 복구
   
3. 처음부터 다시 설치
   → 최후의 수단
```

#### 🔴 상황 5: 프로그램이 멈췄어요 (무한 대기)

**증상**: 아무것도 안 나오고 멈춰 있음

**해결 방법**:
```
1. Ctrl + C로 강제 종료
   
2. 인터넷 연결 확인
   
3. 다시 실행
```

#### 🔴 상황 6: main_v2.py에서 "주문이 허용되지 않았습니다" 에러

**증상**: `OrderNotAllowedError` 메시지

**해결 방법**:
```
PROD(실계좌) 환경에서 이 에러가 나오면:

1. config/prod.yaml 파일 열기
2. order 섹션에서 allow_order: true로 변경
3. 저장 후 다시 실행

★ 이건 1단계 안전장치예요.
  진짜 실계좌 주문할 준비가 됐을 때만 변경하세요!
```

#### 🔴 상황 7: main_v2.py에서 "YES" 입력해도 안 되요

**증상**: YES 입력했는데 주문 취소됨

**해결 방법**:
```
1. 정확히 대문자로 "YES" 입력했는지 확인
   → "yes", "Yes", "예" 등은 안 됨!
   
2. 앞뒤 공백 없이 입력했는지 확인
   → " YES" (앞에 공백) 등은 안 됨!
```

#### 🔴 상황 8: 환경이 DEV인지 PROD인지 모르겠어요

**확인 방법**:
```bash
# main_v2.py 실행하면 시작 시 환경 표시됨:

# DEV 환경이면:
╔═══════════════════════════════════════════════════════════╗
║  📊 모의투자 환경 (DEV)                                    ║
╚═══════════════════════════════════════════════════════════╝

# PROD 환경이면:
╔═══════════════════════════════════════════════════════════╗
║  ⚠️⚠️⚠️  REAL ACCOUNT MODE  ⚠️⚠️⚠️                          ║
║  🔴 실계좌 환경 (PROD)에서 실행 중입니다.                  ║
╚═══════════════════════════════════════════════════════════╝
```

### 도움 요청하기

스스로 해결이 안 되면:

1. **에러 메시지 캡처**하기
2. **어떤 상황**에서 문제가 생겼는지 기록하기
3. **뭘 했는지** 순서대로 적기
4. 프로젝트 **Issue**에 질문 올리기

---

## 18. 이 프로그램을 안전하게 공부용으로 쓰는 방법

### 추천 학습 경로

```
╔═══════════════════════════════════════════════════════════════════════════════╗
║                                                                               ║
║                         🎓 안전한 학습 로드맵                                 ║
║                                                                               ║
║   1주차: 이해하기                                                             ║
║   ┌─────────────────────────────────────────────────────────────────────┐    ║
║   │  - 이 설명서 전체 읽기                                              │    ║
║   │  - 주식 기초 용어 공부 (시가, 종가, 거래량 등)                      │    ║
║   │  - 프로그램 설치하기                                                │    ║
║   └─────────────────────────────────────────────────────────────────────┘    ║
║                                    ↓                                          ║
║   2~4주차: 백테스트 실험                                                      ║
║   ┌─────────────────────────────────────────────────────────────────────┐    ║
║   │  - 다양한 종목으로 백테스트 돌려보기                                │    ║
║   │  - 결과 비교하고 분석하기                                          │    ║
║   │  - "왜 이런 결과가 나왔을까?" 고민하기                              │    ║
║   └─────────────────────────────────────────────────────────────────────┘    ║
║                                    ↓                                          ║
║   2~4개월: 모의투자 경험                                                      ║
║   ┌─────────────────────────────────────────────────────────────────────┐    ║
║   │  - 모의투자로 실시간 운영해보기                                     │    ║
║   │  - 결과 매일 기록하기                                              │    ║
║   │  - 감정 변화 기록하기 (손실 날 때 어떤 기분?)                       │    ║
║   └─────────────────────────────────────────────────────────────────────┘    ║
║                                    ↓                                          ║
║   이후: 심화 학습                                                             ║
║   ┌─────────────────────────────────────────────────────────────────────┐    ║
║   │  - 코드 읽어보기 (Python 공부)                                      │    ║
║   │  - 전략 수정해보기 (파라미터 바꿔보기)                              │    ║
║   │  - 자신만의 전략 만들어보기                                        │    ║
║   └─────────────────────────────────────────────────────────────────────┘    ║
║                                                                               ║
╚═══════════════════════════════════════════════════════════════════════════════╝
```

### 학습 일지 작성 예시

매일 간단하게 기록하면 좋아요:

```
[2025-01-15 학습 일지]

오늘 한 것:
- 삼성전자(005930) 백테스트 실행
- SK하이닉스(000660) 백테스트 실행

결과:
- 삼성전자: +8.5% 수익률, 승률 55%
- SK하이닉스: +12.3% 수익률, 승률 48%

느낀 점:
- SK하이닉스가 수익률은 높은데 승률은 낮네?
- 적게 이기지만 이길 때 크게 이기나 봐

다음에 할 것:
- 두 종목의 거래 내역 자세히 비교해보기
```

### 이 프로그램으로 배울 수 있는 것들

| 분야 | 배울 수 있는 것 |
|------|----------------|
| 주식 | 시장 원리, 기술적 분석, 리스크 관리 |
| 프로그래밍 | Python, API 사용법, 자동화 |
| 데이터 분석 | 백테스트 분석, 성과 측정 |
| 투자 심리 | 감정 관리, 인내심 |

---

## 🚨 이 프로그램으로 절대 해서는 안 되는 행동 5가지

```
╔═══════════════════════════════════════════════════════════════════════════════╗
║                                                                               ║
║                    🚫 절대 금지 행동 TOP 5 🚫                                 ║
║                                                                               ║
║   1. 모의투자 없이 바로 실계좌 사용                                          ║
║      → 반드시 모의투자 3개월 이상 먼저!                                      ║
║                                                                               ║
║   2. 잃으면 안 되는 돈으로 투자                                              ║
║      → 학비, 생활비, 빌린 돈 절대 금지!                                      ║
║                                                                               ║
║   3. API 키를 인터넷에 공개                                                  ║
║      → GitHub, 블로그, SNS에 절대 올리지 마세요!                             ║
║                                                                               ║
║   4. 프로그램을 이해하지 않고 사용                                           ║
║      → 최소한 기본 원리는 이해하고 사용하세요!                               ║
║                                                                               ║
║   5. 백테스트 결과를 100% 신뢰                                               ║
║      → 과거 ≠ 미래, 항상 의심하고 검증하세요!                                ║
║                                                                               ║
╚═══════════════════════════════════════════════════════════════════════════════╝
```

---

## 🎯 안전하게 실력을 키우는 추천 루트

### 초급 (1~2개월)

```
목표: 프로그램 사용법 익히기

할 일:
1. [ ] 설치 완료
2. [ ] 백테스트 10번 이상 실행해보기
3. [ ] 테스트 코드 실행해서 모두 통과 확인
4. [ ] 결과 해석하는 법 익히기
```

### 중급 (2~4개월)

```
목표: 모의투자 경험 쌓기

할 일:
1. [ ] 모의투자 시작
2. [ ] 매일 결과 기록
3. [ ] 최소 3개월 운영
4. [ ] 상승장/하락장 모두 경험
```

### 고급 (4개월~)

```
목표: 심화 학습

할 일:
1. [ ] 코드 읽어보기
2. [ ] 파라미터 바꿔보기 (ATR 기간, 손절 배수 등)
3. [ ] 결과 비교 분석
4. [ ] 자신만의 전략 아이디어 정리
```

---

## 📞 마무리

### 기억해야 할 것

```
╔═══════════════════════════════════════════════════════════════════════════════╗
║                                                                               ║
║   💡 핵심 메시지                                                              ║
║                                                                               ║
║   1. 이 프로그램은 수익을 보장하지 않습니다.                                 ║
║                                                                               ║
║   2. 천천히, 차근차근 배우세요.                                              ║
║                                                                               ║
║   3. 모의투자를 충분히 하고 나서 실계좌를 고민하세요.                        ║
║                                                                               ║
║   4. 잃어도 괜찮은 돈으로만 투자하세요.                                      ║
║                                                                               ║
║   5. 프로그램보다 중요한 건 여러분의 판단입니다.                             ║
║                                                                               ║
╚═══════════════════════════════════════════════════════════════════════════════╝
```

### 응원 메시지

```
자동매매와 주식 투자는 쉽지 않습니다.
하지만 차근차근 배우면 재미있는 분야예요.

이 설명서를 끝까지 읽은 것만으로도 대단합니다!
서두르지 말고, 안전하게 배워나가세요.

화이팅! 🎉
```

---

**문서 버전**: 1.0.0  
**최종 수정일**: 2025년 1월  
**대상 독자**: 코딩 초보자, 주식 투자 입문자

---

> 📝 **피드백**: 이 설명서에서 이해가 안 되는 부분이 있나요? 프로젝트 Issue에 질문해주세요!
